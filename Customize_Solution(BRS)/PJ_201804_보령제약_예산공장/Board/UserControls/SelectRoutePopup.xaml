<icommon:iPharmMESChildWindow
    x:Class="Board.UserControls.SelectRoutePopup"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:icommon="clr-namespace:LGCNS.iPharmMES.Common;assembly=LGCNS.iPharmMES.Common"
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
    xmlns:ctrl="clr-namespace:LGCNS.iPharmMES.Common.UserCtl;assembly=LGCNS.iPharmMES.Common"
    xmlns:c1="http://schemas.componentone.com/winfx/2006/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:local="clr-namespace:Board.UserControls"
    Title="Route Management"
    x:Name="Main" Width="800" Height="800">
    <icommon:iPharmMESChildWindow.Resources>
        <ResourceDictionary>
            <icommon:YN2BoolConverter x:Name="YNConverter"/>
            <!--<local:SelectRoutePopupViewModel x:Key="VM"/>-->
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/LGCNS.iPharmMES.Common;component/GlobalResource/ResourceDictionary.xaml"/>
                <ResourceDictionary x:Name="FilterBtnStyle" Source="/LGCNS.iPharmMES.Controls;component/Themes/iPharmMESFilterBtnStyle.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </icommon:iPharmMESChildWindow.Resources>
    <toolkit:BusyIndicator x:Name="BusyIn" IsBusy="{Binding IsBusy}">
        <!--DataContext="{Binding Source={StaticResource VM}}"-->
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="Loaded">
                <icommon:EventToCommandAction Command="{Binding Path=LoadedCommandAsync}" CommandParameter="{Binding ElementName=Main}"/>
            </i:EventTrigger>
        </i:Interaction.Triggers>
        <Grid x:Name="LayoutRoot" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="35"/>
            </Grid.RowDefinitions>
            <Grid x:Name="searchPanel" Grid.Row="2" VerticalAlignment="Center"  Margin="0 0 0 0" HorizontalAlignment="Center" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                </Grid.ColumnDefinitions>
                <sdk:Label Grid.Column="1" Height="15" HorizontalAlignment="Right" Name="label2" VerticalAlignment="Center" Width="Auto" Content="그룹명" Margin="0,0,0,0"/>
                <TextBox Grid.Column="3" Width="150" Name="groupName" Text="{Binding GroupName, Mode=OneWay}" IsReadOnly="True" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                <sdk:Label Grid.Column="5" Height="15" HorizontalAlignment="Right" Name="label4" VerticalAlignment="Center" Width="Auto" Content="제품명" Margin="0,0,0,0"/>
                <TextBox Grid.Column="7" Width="150" Text="{Binding MaterialName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" KeyDown="Enter_KeyDown"/>
                <!--<Button Grid.Column="9" Content="검색" Width="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <i:InvokeCommandAction Command="{Binding Path=SearchCommand}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </Button>-->
                <Button Style="{Binding Source={StaticResource FilterBtnStyle}}" Grid.Column="9" Height="25" Width="25" HorizontalAlignment="Stretch" 
                                         VerticalAlignment="Stretch" Margin="15 0 0 0">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <i:InvokeCommandAction Command="{Binding Path=SearchCommand}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </Button>
            </Grid>
            <!--<Grid x:Name="searchPanel2" Grid.Row="1" VerticalAlignment="Center"  Margin="0 0 0 0" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                </Grid.ColumnDefinitions>
                <sdk:Label Grid.Column="1" Height="15" HorizontalAlignment="Right" Name="label3" VerticalAlignment="Center" Width="Auto" Content="제품명" Margin="0,0,0,0"/>
                <TextBox Grid.Column="3" Width="150" Text="{Binding MaterialName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" KeyDown="Enter_KeyDown"/>
                <Button Grid.Column="5" Content="검색" Width="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <i:InvokeCommandAction Command="{Binding Path=SearchCommand}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </Button>
            </Grid>-->
            <Grid x:Name="MainPanel" Grid.Row="4"  Margin="0 0 0 0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="750"/>
                </Grid.ColumnDefinitions>

                <Grid Grid.Row ="1" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Stretch" >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200" />
                        <ColumnDefinition Width="500" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="600"/>

                    </Grid.RowDefinitions>
                    <sdk:TreeView Grid.Column="0" Margin="20,0,0,0" Name="MaterialTreeView" Height="600"
                                  ItemsSource="{Binding Path=BR_PHR_SEL_MaterialClass_TreeView_New.OUTDATAs}">
                        <sdk:TreeView.ItemTemplate>
                            <DataTemplate>
                                <Grid Background="Transparent">
                                    <TextBlock Text="{Binding Path=MTCLNAME}"/>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="MouseLeftButtonDown">
                                            <i:InvokeCommandAction 
                                            Command="{Binding Path=DataContext.SearchCommand, ElementName=MaterialTreeView}" 
                                            CommandParameter="{Binding MTCLID}"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Grid>
                            </DataTemplate>
                        </sdk:TreeView.ItemTemplate>
                    </sdk:TreeView>

                    <ScrollViewer Grid.Row="1" Grid.Column="1" Margin="10 0 0 0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <sdk:TreeView ItemsSource="{Binding Path=GroupedMaterials}">
                            <sdk:TreeView.Resources>
                                <DataTemplate x:Key="OperationTemplate">
                                    <StackPanel Orientation="Horizontal">
                                        <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                                        <TextBlock>
                                            <Run Text="{Binding MTODSTAT, StringFormat='[{0}]'}" Foreground="{Binding STATCOLOR}" FontWeight="Bold"/>
                                            <Run Text="{Binding ODNAME}"/>
                                        </TextBlock>
                                    </StackPanel>
                                </DataTemplate>

                                <sdk:HierarchicalDataTemplate x:Key="MaterialTemplate"
                                          ItemTemplate="{StaticResource OperationTemplate}"
                                          ItemsSource="{Binding OperationDefinitions}">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Text="{Binding MTRLID}" FontSize="10" Foreground="Gray"/>
                                        <TextBlock Text="{Binding MTRLNAME}" FontSize="12" FontWeight="Bold"/>
                                    </StackPanel>
                                </sdk:HierarchicalDataTemplate>
                            </sdk:TreeView.Resources>

                            <sdk:TreeView.ItemTemplate>
                                <Binding Source="{StaticResource MaterialTemplate}"/>
                            </sdk:TreeView.ItemTemplate>
                        </sdk:TreeView>
                    </ScrollViewer>
                </Grid>

            </Grid>
            <StackPanel x:Name="Footer" Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Center">
                <Button Margin="5,0" x:Name="btnSave" Width="100" Content="추가">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <i:InvokeCommandAction Command="{Binding Path=AddRouteCommand}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </Button>
                <Button Margin="5,0" x:Name="btnCancel" Width="100" Content="취소" Click="btnCancel_Click"/>
            </StackPanel>
        </Grid>
    </toolkit:BusyIndicator>
</icommon:iPharmMESChildWindow>
